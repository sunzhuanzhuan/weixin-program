<!-- detail.wxml -->
<!-- detail.wxml -->
<import src="/components/loadding/loadding.wxml" />

<template is='loadding' wx:if="{{!showLoadding}}" />

<view>
	<scroll-view wx:if="{{entity.type == 'wxArticle'}}" scroll-y style="height:100%;position: absolute;" bindscroll="recordUserscroll"
	 enable-back-to-top="true">



		<view wx:for="{{nodes}}" wx:key="{{index}}" wx:for-item="node">
			<view wx:if="{{node.type == 'txvVideo'}}" style="heigh:200rpx;padding:4rpx 24rpx;background:#fff">
				<view wx:if="{{isPlayVideo && index == videoCurrent}}">
					<txv-video vid="{{node.vid}}" autoplay="{{true}}" playerid="video{{node.vid}}"></txv-video>
				</view>
				<view wx:else style="height:400rpx;width:700rpx;position:relative ">
					<image style="height:400rpx;width:700rpx;" bindtap="handleChangeTypeVideo" src="{{'http://puui.qpic.cn/vpic/0/'+videoId +'.png/0'}}"
					/>
					<image data-index="{{index}}" class="imgOne" bindtap="handleChangeTypeVideo" src="{{baseImagePlay}}" />

				</view>
			</view>
			<rich-text class="_root {{rootClassMixin}}" wx:if="{{!nodes.type}}" nodes="{{[node]}}"></rich-text>
			<view wx:if="{{node.type == 'wxmpVoice'}}" class="wxmpVoice">
				<view class="audioTitleBox">
					<view class="audioTitle">{{entity.title}}</view>
					<view>
						<slider style="margin:0" blockSize="12" max="{{totalTime}}" backgroundColor="#747474" activeColor="#fff" block-color="#ffd700"
						 bindchanging="handleChanging" min="0" value="{{currentTime}}" block-size="18"></slider>
					</view>
					<view style="height:30rpx;font-size:20rpx;color:#fff;line-height:16rpx;margin-left:-50rpx;">
						<text style="float:left;margin-left:50rpx">{{currentProgress}} </text>
						<text style="float:right;">{{totalProgress}} </text>
					</view>


				</view>
				<view class="audioBoxImg">
					<image wx:if="{{isPlay}}" src="/images/pauseLine.png" class="pauseImgNow" bindtap="handlePauseVideo" />

					<image wx:else class="playImg" src="/images/playing.png" bindtap="handlePlayVideo" />
					<view class="playLetter" bindtap="handlePlayVideo">听一听 </view>
				</view>
			</view>
		</view>


	</scroll-view>
	<!-- 纯视频的布局 -->
	<view wx:if="{{entity.type == 'txvVideo'}}">
		<view style="width:680rpx;height:390rpx;">
			<view style="width:750rpx">
				<txv-video vid="{{entity.txvVid}}" playerid="video"></txv-video>
			</view>
			<view style="width:750rpx;background:#fff;padding:10rpx 0;">
				<view class="nowrapBig" style="padding-top:20rpx;padding-left:34rpx;">{{entity.title}}</view>
				<view class="nowrap" style="font-size:32rpx;padding-left:34rpx;">
					<text style="font-size:24rpx;color:#BBBBBB;">来源</text>
					<text style="font-size:24rpx;color:#BBBBBB"> {{entity.author}}</text>
				</view>
			</view>

		</view>
		<view>
			<view class="relative">相关</view>
			<view class="view1" style="{{isIphoneX?'height:660rpx':'height:520rpx'}};">
				<view wx:for="{{recommendations}}" data-id="{{item.id}}" data-index="{{index}}" bindtap="handleVideo" style="display:flex;flex-direction:rows;{{index === 0?'padding-top:40rpx':''}}">
					<view class="view2">
						<image style="width:260rpx;height:180rpx;{{currentVideo == index?'box-shadow: 0 2rpx 8rpx 8rpx #ffe000;':''}}" src="{{item.coverUrl}}"
						/>


					</view>
					<view style="position:relative;height:180rpx;">
						<view class="nowrap">
							{{item.title}}
						</view>
						<view style="font-size:24rpx;color:#999;position:absolute;bottom:0">

							来源: {{item.author}}</view>

					</view>
				</view>
			</view>

		</view>
	</view>






	<!-- 悬浮部分 -->
	<form name='pushMsgFm' report-submit="{{reportSubmit}}" bindsubmit='getFormID'>
		<button form-type="submit" class="btnForm">
			<view class="fixed {{isShow?'show':''}} state1">
				<view class="floatShadow"></view>
				<view class="boxFloat" style="{{isIphoneX?'height:100rpx':'height:100rpx'}}">
					<view class="btnBoxKonw" style="flex:4;"></view>
					<button class="btnBox btnCollect" style='flex:1' catchtap="handleLikeButtonTapped" form-type="submit" data-item="like" bindgetuserinfo="handleAuthor"
					 open-type="{{type}}" style="{{isIphoneX? 'height:100rpx;': 'height:100rpx'}} ">
						<image class="imgBtn " src="{{isLike? baseImageUrlAllStar:( '/images/star.png')}} "></image>
						<view class="letter ">收藏</view>
					</button>
					<text class="borderLeft"></text>

					<button class="btnBox btnShareFriend" style='flex:1.5' open-type="{{type1}}" data-item="share" form-type="submit" bindgetuserinfo="handleAuthor"
					 style="{{isIphoneX? 'height:100rpx': 'height:100rpx'}} ">
						<image class="imgBtn " src="{{shareButton}} "></image>
						<view class="letter ">分享好友</view>
					</button>
					<text class="borderRight"></text>
					<button class="btnBox " style='flex:2' open-type="{{type}} " form-type="submit " data-item="poster" bindgetuserinfo="handleAuthor "
					 catchtap="handlePoster" style="{{isIphoneX? 'height:100rpx': 'height:100rpx'}}; ">
						<image class="imgBtn " src="/images/circle.png"></image>
						<view class="letter ">分享海报</view>
					</button>
				</view>
				<view class="{{isIphoneX?'bol':''}}  "></view>
			</view>

		</button>
	</form>
</view>
<!-- 悬浮回到首页 -->
<form name='pushMsgFm' report-submit="{{reportSubmit}} " bindsubmit='getFormID' wx:if="{{isRoot}} ">
	<button form-type="submit " class="btnForm ">
		<image src="{{baseImageUrlHome}}" class="{{isRoot? 'goHomeStyle': 'goHomeStyle1'}} state1 " bindtap="handleBack"></image>
	</button>
</form>
<!-- 生成海报 -->
<view wx:if="{{isShowPoster}}" class="posterBox" bindtap="handleSavePicture">
	<canvas class="canvas" canvas-id="shareCanvas" bindlongtap="handleSavePictureToCamera"></canvas>
	<button bindopensetting="handleSavePicture" open-type="{{saveToCamera}}" class="btnSavePicture" style="z-index:99 ">{{btnSavePitcureLetter}}</button>
</view>


<!-- 悬浮的音频 后期作品 -->
<!-- <view wx:if="{{entity.type=='wxArticle' && entity.wxmpVoiceIds.length>0 && isShowListen}}" class="audioBox">
	<view class="coverBox" wx:if="{{entity.type === 'wxArticle' && isPlay === false  && isChangeBig === false }}" style="{{isIphoneX?'bottom:250rpx':'bottom:200rpx'}}">

		<button class="btnBox btnBg" style='flex:2' open-type="{{type}}" bindtap="handleAuthorToPlay" bindgetuserinfo="handleAuthor">
			<image src="/images/listen.png" style="width:116rpx;height:108rpx" />
		</button>
	</view>
	<view class="coverBox" wx:if="{{entity.type === 'wxArticle' && isPlay === true && isChangeBig === false}}" style="{{isIphoneX?'bottom:250rpx':'bottom:200rpx'}}">
		<button class="btnBox btnBg" style='flex:2' open-type="{{type}}" bindtap="handleAuthorToPause" bindgetuserinfo="handleAuthor">
			<image src="/images/pause.png" style="width:116rpx;height:108rpx" />
		</button>

	</view>
	<view class="shinkBoxTrue" wx:if="{{entity.type === 'wxArticle' && isChangeBig === true}}" style="{{isIphoneX?'bottom:156rpx':'bottom:100rpx'}}">
		<view class="shinkBox" bindtap="handleShink">
			<text class="shink">收起 </text>
		</view>

		<view class="audioTitleBox">
			<view class="audioTitle">{{entity.title}}</view>
			<view>
				<slider style="margin:0" blockSize="12" max="{{totalTime}}" backgroundColor="#747474" activeColor="#fff" block-color="#ffd700"
				 bindchanging="handleChanging" min="0" value="{{currentTime}}" block-size="18"></slider>
			</view>
			<view style="height:30rpx;font-size:20rpx;color:#fff;line-height:16rpx;margin-left:-50rpx;">
				<text style="float:left;margin-left:50rpx">{{currentProgress}} </text>
				<text style="float:right;">{{totalProgress}} </text>
			</view>


		</view>

		<view class="audioBoxImg">

			<image wx:if="{{isPlay}}" src="/images/pauseLine.png" class="pauseImgNow" bindtap="handlePauseVideoNow" />

			<image wx:else class="playImg" src="/images/playing.png" bindtap="handlePlayVideoNow" />
			<view class="playLetter" bindtap="handlePlayVideoNow">听一听 </view>
		</view>
	</view>
</view> -->
