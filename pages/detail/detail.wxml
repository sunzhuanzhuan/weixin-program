<!-- detail.wxml -->
<!-- detail.wxml -->
<view>
    
    <scroll-view wx:if="{{entity.type == 'wxArticle'}}" scroll-y style="height:100%;position: absolute;" bindscroll="recordUserscroll" enable-back-to-top="true">
   
        <!-- 播放视频的位置 -->
        <!-- <view wx:if="{{ videoSource.length>0}}" style="heigh:200rpx;padding:4rpx 24rpx;{{videoTop}};background:#fff">
            <view wx:if="{{isPlayVideo}}">
                <txv-video vid="{{videoId}}" playerid="video" autoplay="{{true}}" muted="{{isMuted}}"></txv-video>
            </view>
            <view  wx:else style="height:400rpx;width:700rpx;position:relative ">
                <image style="height:400rpx;width:700rpx;" bindtap="handleChangeTypeVideo" src="{{'http://puui.qpic.cn/vpic/0/'+videoId +'.png/0'}}"/>
                <image style="width:132rpx;height:132rpx;position:absolute;top:50%;left:50%;margin-top:-66rpx;margin-left:-66rpx" bindtap="handleChangeTypeVideo" src="/images/play.png"/>
           
           </view>
           <view wx:if="{{videoSource.length==1}}" style=" height:80rpx;padding: 30rpx 0;background:#fff">
                <view bindtap="handleIsMutedFromArtical" style="width:100rpx; height: 70rpx;line-height:70rpx;float: right;text-align: center;margin-right: 30rpx;margin-top: -2rpx">
                    <image style="width:40rpx; height: 40rpx;" src="{{isMuted?'/images/mute.png':'/images/noMute.png'}}"></image>
                </view>
                <text style="color: #E6E6E6;display:inline-block;height:40rpx;margin-right: 50rpx;float: right;line-height:10px;">
                    |
                </text>
            </view>
            <view wx:else style="text-align: center;">
                <view wx:for="{{videoSource}}" data-videoId="{{index}}" bindtap="handleVideoTapFromArtical" class="{{selectedCricle == index?'borderCircle':'borderNum'}}">
                    <text style="font-size: 24rpx">视频{{index+1}}</text>
                </view>
                <view bindtap="handleIsMutedFromArtical" style="width:100rpx; height: 70rpx;line-height:70rpx;float: right;text-align: center;margin-right: 30rpx;margin-top: 46rpx">
                    <image style="width:40rpx; height: 40rpx;" src="{{isMuted?'/images/mute.png':'/images/noMute.png'}}"></image>
                </view>
                <text class="line"></text>
            </view>
        </view> -->

        <view wx:for="{{nodes}}" wx:key="{{index}}" wx:for-item="node">
            <!-- <txv-video wx:if="{{node.type == 'txvVideo'}}" vid="{{node.vid}}" playerid="video{{node.vid}}" muted="{{isMuted}}"></txv-video> -->

            <view  wx:if="{{node.type == 'txvVideo'}}" style="heigh:200rpx;padding:4rpx 24rpx;background:#fff">
                <view wx:if="{{isPlayVideo}}">
                    <txv-video vid="{{node.vid}}" autoplay="{{true}}" playerid="video{{node.vid}}"></txv-video>
                </view>
                <view  wx:else style="height:400rpx;width:700rpx;position:relative ">
                    <image style="height:400rpx;width:700rpx;" bindtap="handleChangeTypeVideo" src="{{'http://puui.qpic.cn/vpic/0/'+videoId +'.png/0'}}"/>
                    <image style="width:132rpx;height:132rpx;position:absolute;top:50%;left:50%;margin-top:-66rpx;margin-left:-66rpx" bindtap="handleChangeTypeVideo" src="/images/play.png"/>
            
                </view>
            </view>
            <rich-text class="_root" wx:if="{{nodes.type === undefined}}"  nodes="{{[node]}}"></rich-text>
        </view>
         
       
    </scroll-view>
    <!-- 纯视频的布局 -->
     <view wx:if="{{entity.type == 'txvVideo'}}">
       <view style="margin-left:34rpx;width:680rpx;height:390rpx;">
            <txv-video vid="{{entity.txvVid}}" playerid="video"></txv-video>
            <view class="nowrapBig" style="margin-top:20rpx">{{entity.title}}</view>
            <view class="nowrap" style="font-size:32rpx;">
                <text  style="font-size:20rpx;color:#FF6156;border:1px solid #FF6156;padding:0 6rpx;border-radius:6rpx">视频</text>
               <text style="font-size:24rpx;color:#999"> {{entity.author}}</text>
            </view>
        </view>
        <view>
            <view style="margin-left:34rpx;margin-top:100rpx;font-size:28rpx;color: #333;margin-bottom:20rpx;"> 相关视频</view>
            <view style="height:400px;overflow-y:scroll"> 
                <view wx:for="{{recommendations}}"  data-id="{{item.id}}" bindtap="handleVideo" style="display:flex;flex-direction:rows">
                    <view style="width:260rpx;height:180rpx;margin:0 34rpx;margin-bottom:50rpx;">
                        <image style="width:260rpx;height:180rpx;" src="{{item.coverUrl}}"/>
                    </view>
                    <view style="">
                        <view class="nowrap">
                            {{item.title}}
                        </view>
                        <view style="font-size:24rpx;color:#999">
                             <text  style="font-size:20rpx;color:#FF6156;border:1px solid #FF6156;display:inline-block;margin-right:10rpx;padding:0 6rpx;border-radius:6rpx">视频</text>
                            来源: {{item.author}}</view>
                    </view>
                </view>
            </view >
            
        </view>
    </view>
    





    <!-- 悬浮部分 -->
    <form name='pushMsgFm' report-submit='true' bindsubmit='getFormID'>
        <button form-type="submit" class="btnForm">
            <view class="fixed {{isShow?'show':''}} state1">
                <view class="floatShadow"></view>
                <view style="display: flex;flex-direction: row;background: #fff;overflow:hidden;{{isIphoneX?'height:100rpx':'height:100rpx'}};width:100%">
                    <view wx:if="{{isEyes}}" class="btnBoxKonw" style="flex:4;"></view>
                    <button wx:else class="btnBoxKonw" form-type="submit" data-item="know" bindgetuserinfo="handleAuthor" open-type="{{type}}" style="flex:4;{{isIphoneX?'height:100rpx':'height:100rpx'}}" catchtap="handleJump">
                        <!-- hidden="{{isEyes}}" -->
                        <image class="imgBtnKonw" src="/images/eye.png"></image>
                        <view class="letterKonw">让朋友知道我在读</view>
                    </button>
                    <button class="btnBox" style='flex:1' catchtap="handleLikeButtonTapped" form-type="submit" data-item="like" bindgetuserinfo="handleAuthor" open-type="{{type}}" style="overflow:hidden;text-align:center;opacity: 1;background:#ffffff;flex:1;position: relative;z-index: 2;{{isIphoneX?'height:100rpx;':'height:100rpx'}}">
                        <image class="imgBtn" src="{{isLike?('/images/allStar.png'):('/images/star.png')}}"></image>
                        <view class="letter">收藏</view>
                    </button>
                    <text style="border-left:1rpx solid #E6E6E6;height:36rpx;display:inline-block;width:2rpx;margin-top:34rpx;" ></text>

                    <button class="btnBox" style='flex:1.5' open-type="{{type1}}" data-item="share" form-type="submit" bindgetuserinfo="handleAuthor" style="overflow:hidden;text-align:center;border-color: #ffffff;opacity: 1;background:#ffffff;flex:1.5;position: relative;z-index: 2;{{isIphoneX?'height:100rpx':'height:100rpx'}}">
                        <image class="imgBtn" src="{{shareButton}}"></image>
                        <view class="letter">分享好友</view>
                    </button>
                    <text style="border-right:1rpx solid #E6E6E6;height:36rpx;display:inline-block;width:2rpx;margin-top:34rpx;" ></text>
                    <button class="btnBox" style='flex:2' open-type="{{type}}" form-type="submit" data-item="poster" bindgetuserinfo="handleAuthor" catchtap="handlePoster" style="{{isIphoneX?'height:100rpx':'height:100rpx'}};">
                        <image class="imgBtn" src="/images/circle.png"></image>
                        <view class="letter">分享海报</view>
                    </button>
                </view>
                <view wx:if="{{isIphoneX}}" class="bol"></view>
                <view wx:else></view>
            </view>
        </button>
    </form>
</view>
<!-- 悬浮回到首页 -->
<form name='pushMsgFm' report-submit='true' bindsubmit='getFormID' wx:if="{{isRoot}}">
    <button form-type="submit" class="btnForm">
        <image src="/images/goHome.png" class="{{isRoot?'goHomeStyle':'goHomeStyle1'}} state1" bindtap="handleBack"></image>
    </button>
</form>
<!-- 生成海报 -->
<view wx:if="{{isShowPoster}}" style="position:fixed;bottom:0;left:0;right:0;top:0;background:rgba(0,0,0,0.65);z-index:91" bindtap="handleSavePicture">
    <canvas style="width: 640rpx; height: 760rpx;background:#fff;margin-top:160rpx;margin-left:54rpx;" canvas-id="shareCanvas"></canvas>
    <button bindtap="handleSavePicture" class="btnSavePicture" style="z-index:99">已保存到相册，记得分享哦</button>
</view>


<!-- 悬浮的音频 后期作品 -->
<view  wx:if="{{entity.type == 'wxArticle' && entity.wxmpVoiceIds.length>0  && isShowListen}}" style="border-radius:8rpx 8rpx 0 0;overflow:hidden">
    <view wx:if="{{entity.type === 'wxArticle' && isPlay === false  && isChangeBig === false }}" style="position:fixed;{{isIphoneX?'bottom:250rpx':'bottom:200rpx'}};right:30rpx;z-index:90">
        <image src="/images/listen.png" style="width:116rpx;height:108rpx" bindtap="handlePlayVideo"/>
    </view>
    <view wx:if="{{entity.type === 'wxArticle' && isPlay === true && isChangeBig === false}}" style="position:fixed;{{isIphoneX?'bottom:250rpx':'bottom:200rpx'}};right:30rpx;z-index:90">
        <image src="/images/pause.png" style="width:116rpx;height:108rpx" bindtap="handlePauseVideo"/>
    </view>
    <view wx:if="{{entity.type === 'wxArticle' && isChangeBig === true}}" style="overflow:hidden;position:fixed;{{isIphoneX?'bottom:156rpx':'bottom:100rpx'}};z-index:90;width:100%;height:100rpx;background:rgba(0,0,0,0.85);line-height:100rpx;border-radius:8rpx 8rpx 0 0">
        <view style="display:inline-block;width:110rpx;height:100rpx;line-height:100rpx;background:#000;overflow:hidden;font-size:24rpx;color:#fff;vertical-align:top;border-radius:20rpx 0 0 0;" bindtap="handleShink">
        <text style="border-right:1px solid #666666;padding-right:27rpx;padding-left:32rpx;">收起 </text> 
        </view>
        
        <view style="display:inline-block;padding-left:4%;width:470rpx;height:100rpx;line-height:100rpx;background:#000;overflow:hidden;vertical-align:top"  >
            <view style="font-size:24rpx;color:#fff;height:40rpx;width:100%;line-height:56rpx;">{{entity.title}}</view>
            <view>
                <slider style="margin:0" blockSize="12" max="{{totalTime}}" backgroundColor="#747474" activeColor="#fff" block-color="#ffd700" bindchanging="handleChanging" min="0" value="{{currentTime}}" block-size="18"></slider>
            </view>
            <view style="height:30rpx;font-size:20rpx;color:#fff;line-height:16rpx;margin-left:-50rpx;">
                <text style="float:left;margin-left:50rpx">{{currentProgress}}  </text>
                <text style="float:right;">{{totalProgress}}  </text>
            </view>
            
            
        </view>
        
        <view style="display:inline-block;width:140rpx;height:100rpx;line-height:100rpx;background:#000;vertical-align:top;;border-radius:0 20rpx 0 0;" >

            <image wx:if="{{isPlay}}" src="/images/pauseLine.png" style="vertical-align:middle;width:24rpx;height:34rpx;margin-left:60rpx" bindtap="handlePauseVideoNow"/>

            <image wx:else src="/images/playing.png" style="vertical-align:middle;width:24rpx;height:34rpx;margin-left:60rpx;display:block;overflow:hidden;margin-top:18rpx" bindtap="handlePlayVideoNow"/>
             <view style="display:inline-block;font-size:24rpx;color:#fff;width:100%;height:80rpx;line-height:50rpx;overflow:hidden;margin-left:40rpx;" bindtap="handlePlayVideoNow">听一听 </view> 
        </view>
    </view>
</view>
